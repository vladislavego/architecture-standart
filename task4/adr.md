### **Название задачи:**
MVP (расширение): Передача ставок по депозитам в кол-центры

### **Автор:**
Vladislav

### **Дата:**
2025-12-17

---

### **Функциональные требования**

| № | Действующие лица или системы | Use Case | Описание |
|---|------------------------------|----------|----------|
| 1 | Оператор кол-центра банка | Консультация по ставкам | Оператор кол-центра может видеть актуальные ставки по депозитам для консультации клиентов |
| 2 | Система кол-центра, Deposit Applications Service | Получение ставок | Система кол-центра получает актуальные ставки через уже реализованный сервис заявок на депозит |
| 3 | Партнёрский кол-центр | Консультация по ставкам | Оператор партнёрского кол-центра может консультировать клиентов по актуальным ставкам |
| 4 | Deposit Applications Service, Партнёрский кол-центр | Передача ставок файлом | Deposit Applications Service формирует файл со ставками и передаёт его партнёру |
| 5 | Бэк-офис депозитов | Управление ставками | Процесс управления ставками остаётся без изменений на этапе MVP |

---

### **Нефункциональные требования**

| № | Требование |
|---|-----------|
| 1 | Расширение не должно увеличивать онлайн-нагрузку на АБС |
| 2 | Решение должно переиспользовать компоненты MVP |
| 3 | Обмен с партнёрским кол-центром реализуется без API |
| 4 | Актуальность ставок должна быть контролируемой и воспроизводимой |
| 5 | Изменения должны быть минимальными для подрядчиков |

---

### **Решение**

#### Общее описание

Для реализации нового кейса используется архитектура MVP открытия депозитов,
спроектированная в предыдущем шаге.

В качестве точки интеграции и распространения ставок используется уже введённый
**Deposit Applications Service**, который:
- получает данные о ставках из АБС через существующий адаптер интеграции;
- предоставляет ставки внутреннему кол-центру через управляемую интеграцию;
- формирует файл со ставками для партнёрского кол-центра.

АБС остаётся единым источником истины по ставкам.
Новых ключевых архитектурных компонентов в рамках Task4 не добавляется.

#### Диаграмма контекста (C4 Context)

Файл: `c4-context-rates-extension.puml`

Изменения относительно MVP:
- добавлено использование Deposit Applications Service системой кол-центра;
- добавлен файловый канал передачи ставок партнёрскому кол-центру.

#### Диаграмма компонентов (C4 Container)

Файл: `c4-container-rates-extension.puml`

Изменения относительно MVP:
- расширена ответственность Deposit Applications Service;
- расширен адаптер интеграции АБС для передачи ставок;
- добавлен компонент формирования файлов (как часть сервиса заявок).

---

### **Альтернативы**

1. Прямая интеграция системы кол-центра с АБС  
   **Минусы:** рост нагрузки на АБС, нарушение архитектуры MVP.

2. Ручная передача ставок по почте  
   **Минусы:** неуправляемый процесс, высокий риск ошибок.

3. Выделение отдельного сервиса ставок  
   **Минусы:** избыточно для MVP, увеличивает сложность архитектуры.

---

### **Недостатки, ограничения, риски**

1. Задержка обновления ставок у партнёра  
   *Митигирование:* регламент обновлений и временные метки в файлах.

2. Ошибки формирования файлов  
   *Митигирование:* валидация данных и логирование.

3. Рост нагрузки на Deposit Applications Service  
   *Митигирование:* масштабирование сервиса и кеширование.